<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Components/ForgotPassword/ForgotPassword.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Components/ForgotPassword/ForgotPassword.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { Component } from "react";
import "./ForgotPassword.css";
import Header from  "../WelcomeRelated/Header";
import Footer from "../WelcomeRelated/Footer";
import {BrowserRouter as Router, Redirect} from "react-router-dom";
import {Link} from "react-router-dom";

const initialState = {
  /**Input string for the email
   * @memberof ForgotPassword
   * @type {string}
   */
  email: "",
   /**Error message for wrong input
   * @memberof ForgotPassword
   * @type {string}
   */
  emailError: ""
}
 /**Email format that must be entered by the user
   * @memberof ForgotPassword
   * @type {expression}
   */
const emailFormat = RegExp(
  /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/
);
/** Class ForgotPassword to get an email from the user to send the instructions of resetting the password
 * @category ForgotPassword
 * @extends Component
 */
export class ForgotPassword extends Component {
  constructor(props){
    super(props);
 this.state = initialState;
  }
 /**A function that validates user input(must be an email)
   * @memberof ForgotPassword
   * @func validate
   */
 validate = () => {
   let inp = this.state.email;
   let emailError="";
   let proceed=true;
   if (inp.length === 0)
   {
    emailError = "This field is required.";
    this.setState({emailError});
    if (document.querySelector("#my-text"))
    {
    document.querySelector("#my-text").classList.add("red-border");
    }
    proceed = false;
   }
   else 
   {
    emailError = "";
    this.setState({inp, emailError});
    if (document.querySelector("#my-text"))
    {
    document.querySelector("#my-text").classList.remove("red-border");
    }
    proceed = true;
   }
   return proceed;
  };
 /**A function that reflects changes in input to the state of the class
   * @memberof ForgotPassword
   * @func handleChange
   */
  handleChange = event => {
    let inp = this.state.email;
    inp = event.target.value;
    this.state.email = inp;
    this.validate();
  };
 /**A function that handles form submission and implements the fetch request to send the instructions on the provided email
   * @memberof ForgotPassword
   * @func clickSubmit
   */
  clickSubmit = event => {
    let email = this.state.email;
    let emailError = this.state.emailError;
    this.setState({emailError});
    //event.preventDefault();
    if (!emailFormat.test(email) &amp;&amp; email.length !== 0)
    {
      if (document.querySelector("#my-text"))
      {

      document.querySelector("#my-text").classList.add("red-border");
      
      }
      emailError = "The email address you entered is invalid.";
      this.setState({emailError});
    }
    else if(this.validate())
    {
      this.setState({initialState});
     const {email}=this.state;
     if (document.querySelector("#my-text"))
      {
      document.querySelector("#my-text").classList.remove("red-border");
      }
   /**Prerequisites for fetch request
   * @memberof ForgotPassword
   * @type {object}
   */
      const requestOptions = {
        method:"POST",
        headers: {'Content-Type':  'application/json'},
        body: JSON.stringify({ email: email })
      }
      console.log(requestOptions.body);
   /**URL for fetch request
   * @memberof ForgotPassword
   * @type {string}
   */
      var url = 'http://52.14.190.202:8000/users/forgot'; 
      fetch(url,requestOptions)
        .then((response) => {
          return response.json();
        })
        .then((data) => {
          console.log(data);
          if (data.message === "Email Sent Successfully")
          {
            this.props.history.push('/logIn/forgotpassword/success');
          }
          else if (data.message == "Email Cannot be sent a problem while sending email")
          {
            this.state.emailError = "Your request cannot be performed. Please try again later.";
          }
          else if (data.message == "Email not found")
          {
           this.state.emailError = "The email you entered does not exist in the Spotify server."  
          }
        })
        .catch((error)=>{
          console.log(error);
        })

    }
  };

render(){
  // document.querySelector("#my-text").addEventListener("click", function(e){ e.key == 'enter'? document.querySelectpr("#anchor").click() : null});
return(
  &lt;div className="forgot-password">
    &lt;Header />
    &lt;div className="container">
      &lt;h1 className="text-center">&lt;strong>Password Reset&lt;/strong>&lt;/h1>
      &lt;p className="text-center" style={{fontWeight:"500"}} id="paragraph">Enter your &lt;strong>Spotify email address&lt;/strong> that you used to register. We'll send you an email with your username and a link to reset your password.&lt;/p>
      &lt;form method="POST" id="action-form" noValidate action="/logIn/forgotpassword/success">
        &lt;div  className= "d-flex justify-content-start pad" id="labelling">&lt;label htmlFor="my-text" className="mb-1">&lt;strong>Email address&lt;/strong>&lt;/label>&lt;/div>
        &lt;div className= "d-flex justify-content-center">&lt;input type="email" name="email" required className="mb-3 mt-0 pt-1 pb-1" id="my-text" onChange={this.handleChange} />&lt;/div>
        &lt;div className="justify-content-start red pad" id="empty-input">{this.state.emailError}&lt;/div>
        &lt;div className="d-flex justify-content-center">&lt;Link to="/logIn/forgotpassword/success" className="button-spacing d-flex justify-content-center">&lt;button className="btn btn-success px-5 py-2 mt-4 padded" id="anchor" role="button" type="submit" onClick={this.clickSubmit}>SEND&lt;/button>&lt;/Link>&lt;/div>
      &lt;/form>
    &lt;/div>
    &lt;Footer />
  &lt;/div>

);
}
}
export default ForgotPassword;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AlbumPage.html">AlbumPage</a></li><li><a href="ComponentBlock.html">ComponentBlock</a></li><li><a href="CreateNewPassword.html">CreateNewPassword</a></li><li><a href="DropDownMenu.html">DropDownMenu</a></li><li><a href="ForgotPassword.html">ForgotPassword</a></li><li><a href="HelpPage.html">HelpPage</a></li><li><a href="HomePage.html">HomePage</a></li><li><a href="HomePageNavbar.html">HomePageNavbar</a></li><li><a href="HomePageSidebar.html">HomePageSidebar</a></li><li><a href="LikedSongsComponent.html">LikedSongsComponent</a></li><li><a href="MediaObject.html">MediaObject</a></li><li><a href="PasswordIsNew.html">PasswordIsNew</a></li><li><a href="Premium.html">Premium</a></li><li><a href="RelatedArtistsContent.html">RelatedArtistsContent</a></li><li><a href="SeeAllArtists.html">SeeAllArtists</a></li><li><a href="Success.html">Success</a></li><li><a href="YourLibraryNavbar.html">YourLibraryNavbar</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Footer">Footer</a></li><li><a href="global.html#Header">Header</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Sat Apr 11 2020 22:10:56 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
